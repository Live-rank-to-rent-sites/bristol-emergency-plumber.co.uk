---
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import StickyCtaBar from '../components/StickyCtaBar.astro';
import '../styles/style.css';

interface Props {
  title: string;
  description: string;
  canonical: string;
  ogTitle?: string;
  ogDescription?: string;
  ogImage?: string;
  robots?: string;
  keywords?: string;
  author?: string;
  jsonLd?: object[];
  currentPage?: string;
}

const {
  title,
  description,
  canonical,
  ogTitle = title,
  ogDescription = description,
  ogImage = 'https://bristolemergencyplumber.co.uk/assets/images/hero-emergency-plumber-bristol.webp',
  robots = 'index, follow',
  keywords,
  author = 'Bristol Emergency Plumber',
  jsonLd = [],
  currentPage = '',
} = Astro.props;
---

<!DOCTYPE html>
<html lang="en-GB">
<head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/svg+xml" href="/assets/images/favicon.svg">
    <link rel="icon" href="/favicon.ico" sizes="32x32">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content={description}>
    {keywords && <meta name="keywords" content={keywords}>}
    <meta name="robots" content={robots}>
    <meta name="author" content={author}>
    <link rel="canonical" href={canonical}>
    <title>{title}</title>

    <meta property="og:title" content={ogTitle}>
    <meta property="og:description" content={ogDescription}>
    <meta property="og:url" content={canonical}>
    <meta property="og:type" content="website">
    <meta property="og:locale" content="en_GB">
    <meta property="og:image" content={ogImage}>
    <meta property="og:image:width" content="1920">
    <meta property="og:image:height" content="800">
    <meta property="og:image:type" content="image/webp">

    {/* Critical CSS inlined for faster render */}
    <style>
        :root{--primary-color:#1a5f7a;--primary-dark:#134b61;--secondary-color:#e63946;--accent-color:#f4a261;--text-color:#2d3436;--text-light:#636e72;--bg-light:#f8f9fa;--white:#fff;--shadow:0 2px 10px rgba(0,0,0,.1)}*{margin:0;padding:0;box-sizing:border-box}body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,sans-serif;font-size:16px;line-height:1.6;color:var(--text-color);background-color:var(--white);padding-bottom:56px}.container{max-width:1200px;margin:0 auto;padding:0 20px}a{color:var(--primary-color);text-decoration:none}h1,h2,h3{font-weight:700;line-height:1.3;margin-bottom:1rem;color:var(--text-color)}h1{font-size:2.5rem}.btn{display:inline-block;padding:14px 28px;border-radius:5px;font-weight:600;text-align:center;cursor:pointer;border:none;font-size:1rem}.btn-primary{background-color:var(--secondary-color);color:var(--white)}.btn-secondary{background-color:var(--white);color:var(--primary-color);border:2px solid var(--primary-color)}.site-header{background-color:var(--white);box-shadow:var(--shadow);position:sticky;top:0;z-index:1000}.header-top{background-color:var(--primary-color);color:var(--white);padding:8px 0}.header-top .container{display:flex;justify-content:space-between;align-items:center}.emergency-banner{font-weight:600;font-size:.9rem}.main-nav .container{display:flex;justify-content:space-between;align-items:center;padding:15px 20px}.logo{font-size:1.5rem;font-weight:700;color:var(--primary-color);display:flex;align-items:center;gap:10px}.logo img{display:block}.nav-links{display:flex;list-style:none;gap:30px}.nav-links a{color:var(--text-color);font-weight:500}.cta-button{background-color:var(--secondary-color);color:var(--white);padding:12px 24px;border-radius:5px;font-weight:600}.hamburger{display:none;background:none;border:none;cursor:pointer;padding:8px;flex-direction:column;gap:5px}.hamburger span{display:block;width:24px;height:2px;background-color:var(--text-color)}.hero,.page-hero{background:linear-gradient(135deg,var(--primary-color) 0%,var(--primary-dark) 100%);color:var(--white);padding:60px 0;text-align:center}.hero{background:linear-gradient(135deg,rgba(26,95,122,0.6) 0%,rgba(19,75,97,0.65) 100%),url('/assets/images/hero-emergency-plumber-bristol.webp') center/cover no-repeat;padding:80px 0}.hero h1,.page-hero h1{color:var(--white);font-size:3rem;margin-bottom:1rem}.page-hero h1{font-size:2.5rem}.hero-subtitle{font-size:1.5rem;margin-bottom:1rem;opacity:.95}.hero-text{font-size:1.125rem;max-width:700px;margin:0 auto 2rem;opacity:.9}.hero-grid{display:grid;grid-template-columns:1fr 400px;gap:40px;align-items:center;text-align:left}.hero-content{text-align:left}.hero-cta{display:flex;gap:15px;justify-content:flex-start;margin-bottom:2rem;flex-wrap:wrap}.trust-signals{display:flex;gap:30px;justify-content:flex-start;flex-wrap:wrap;font-size:.95rem}.trust-signals span{opacity:.95}.hero-form{background-color:var(--white);padding:30px;border-radius:10px;box-shadow:0 10px 40px rgba(0,0,0,.2)}.hero-form h2{color:var(--primary-color);font-size:1.5rem;margin-bottom:.5rem}.hero-form p{color:#636e72;font-size:.9rem;margin-bottom:1.25rem}.hero-form .form-group{margin-bottom:1rem}.hero-form .form-group label{display:block;margin-bottom:.35rem;font-weight:500;font-size:.9rem;color:var(--text-color)}.hero-form .form-group input,.hero-form .form-group textarea,.hero-form .form-group select{width:100%;padding:10px 12px;border:1px solid #dee2e6;border-radius:5px;font-size:.95rem;font-family:inherit}.btn-block{display:block;width:100%;padding:14px;font-size:1.1rem}.skip-link{position:absolute;top:-40px;left:0;background:var(--primary-color);color:var(--white);padding:8px 16px;z-index:1001;transition:top .3s}.skip-link:focus{top:0}.sticky-cta{position:fixed;bottom:0;left:0;right:0;background:#d63031;z-index:999;box-shadow:0 -2px 10px rgba(0,0,0,.2);text-align:center}.sticky-cta a{display:block;color:#fff;font-weight:700;font-size:1.125rem;padding:14px 20px;text-decoration:none}@media(max-width:768px){h1{font-size:2rem}.hero h1,.page-hero h1{font-size:2.25rem}.hero-subtitle{font-size:1.25rem}.hamburger{display:flex}.main-nav .container{flex-wrap:wrap}.nav-links{display:none;order:3;width:100%;flex-direction:column;align-items:center;padding-top:15px;gap:10px}.nav-links.nav-open{display:flex}.hero-grid{grid-template-columns:1fr;text-align:center}.hero-content{text-align:center}.hero-content .hero-cta{justify-content:center}.hero-content .trust-signals{justify-content:center}.hero-cta{flex-direction:column;align-items:center}.trust-signals{flex-direction:column;gap:10px}.hero-form-wrapper{max-width:500px;margin:0 auto}.header-top .container{flex-direction:column;gap:5px}}
    </style>

    <slot name="extraHead" />

    {jsonLd.map((ld) => (
        <script type="application/ld+json" set:html={JSON.stringify(ld)} />
    ))}
</head>
<body>
    <a href="#main-content" class="skip-link">Skip to main content</a>
    <Header currentPage={currentPage} />

    <slot />

    <Footer />
    <StickyCtaBar />

    <script>
    document.querySelector('.hamburger')?.addEventListener('click', function() {
        const nav = document.querySelector('.nav-links');
        const expanded = this.getAttribute('aria-expanded') === 'true';
        this.setAttribute('aria-expanded', String(!expanded));
        nav?.classList.toggle('nav-open');
        this.classList.toggle('is-active');
    });
    </script>
</body>
</html>
